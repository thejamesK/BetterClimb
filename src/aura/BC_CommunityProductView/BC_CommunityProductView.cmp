<aura:component description="BC_CommunityProductView" access="global" implements="forceCommunity:availableForAllPageTypes,force:hasRecordId" controller="BC_CommunityProductViewController">
    <aura:attribute name="record" type="Object"/>
    <aura:attribute name="simpleRecord" type="Object"/>
    <aura:attribute name="recordError" type="String"/>
    <aura:attribute name="productWrapper" type="BC_ProductWrapper" />
    <aura:attribute name="productRating" type="BC_RatingWrapper" />
    <aura:handler name="init" value="{!this}" action="{!c.init}" />

    <aura:handler name="ProductReviewAdded" event="c:BC_ProductReviewAdded" action="{!c.onProductReviewAdded}"/>

    <div style="padding-left: 15rem; padding-right: 15rem;">
        <lightning:layout multipleRows="true">
            <lightning:layoutItem size="8" padding="around-small">
                <div style="display: flex; justify-content: center">
                    <div style="width: 350px; object-fit: contain;">
                        <lightning:carousel disableAutoRefresh="false" disableAutoScroll="false">
                            <aura:iteration items="{!v.productWrapper.productImageUrls}" var="image">
                                <lightning:carouselImage src="{!image}">
                                </lightning:carouselImage>
                            </aura:iteration>
                        </lightning:carousel>
                    </div>
                </div>
            </lightning:layoutItem>
            <lightning:layoutItem size="4" padding="around-small">
                    <div style="display: flex; flex-direction: column; justify-content: space-evenly; height: 20rem;">
                        <div>
                            <div class="slds-text-heading--label" style="font-size: 30px; color: black;">
                                {!v.productWrapper.productName}
                            </div>
                            <div class="slds-text-heading--label" style="font-size: 25px; color: black; padding-top: 1rem;">
                                <lightning:formattedNumber value="{!v.productWrapper.productPrice}" currencyCode="{!$Locale.currencyCode}" style="currency" />
                            </div>
                            <aura:if isTrue="false">
                                <div class="slds-text-heading--label" style="font-size: 25px; color: black; padding-top: 1rem; text-decoration: line-through">
                                    <lightning:formattedNumber value="{!v.productWrapper.productPrice}" currencyCode="{!$Locale.currencyCode}" style="currency" />
                                </div>
                                <div class="slds-text-heading--label" style="font-size: 25px; color: red;">
                                    <lightning:formattedNumber value="{!v.productWrapper.productPrice}" currencyCode="{!$Locale.currencyCode}" style="currency" />
                                </div>
                            </aura:if>
                        </div>
                        <div style="display: flex; flex-direction: column;">
                            <div>
                                {!$Label.c.BC_LabelQuantity}
                            </div>
                            <div style="display: flex;">
                                <div style="width: 5rem; padding-right: 1rem;">
                                    <ui:inputNumber placeholder="1" value="{!v.productWrapper.productQuantity}"/>
                                </div>
                                <div>
                                    <lightning:button label="{!$Label.c.BC_AddToCart}" iconName="utility:cart" variant="brand" onclick="{!c.handleAddToBasket}"/>
                                </div>
                            </div>
                        </div>
                    </div>
            </lightning:layoutItem>
            <lightning:layoutItem size="8">
                <div>
                    <hr style="background: darkgray" />
                </div>
            </lightning:layoutItem>
            <aura:if isTrue="{!v.productWrapper.productDescription != null}">
                <lightning:layoutItem size="8">
                    <div class="slds-text-heading--label" style="color: black; font-weight: bold; font-size: 18px;">
                        {!v.productWrapper.productDescription}
                    </div>
                </lightning:layoutItem>
                <lightning:layoutItem size="8">
                    <div>
                        <hr style="background: darkgray" />
                    </div>
                </lightning:layoutItem>
            </aura:if>
            <lightning:layoutItem size="8">
                <div>
                    <aura:if isTrue="{!v.productRating.vote_count != null}">
                        <div style="display: flex; align-content: center; justify-content: center">
                            <div style="display: flex; flex-direction: column; justify-content: center">
                                <div style="font-size: 25px">
                                    {!$Label.c.BC_UsersRating}
                                </div>
                                <div style="font-size: 15px; display: inline-flex; justify-content: center; align-items: center; padding-bottom: 3rem;">
                                    <div>
                                        <img src="{!$Resource.star}" style="width: 30px; height: 30px"/>
                                    </div>
                                    <div style="height: 30px; display: flex; align-items: center;">
                                        <div style="padding-left: 5px; font-weight: bold; font-size: 25px">
                                                {!v.productRating.vote_average}
                                        </div>
                                        <div style="padding-left: 5px; font-size: 13px; color: darkgrey">
                                            {!format($Label.c.BC_OnVotes, v.productRating.vote_count)}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </aura:if>
                    <aura:if isTrue="{!v.productRating.vote_count == null}">
                        <div style="display: flex; flex-direction: column; font-size: 20px; font-weight: bold; padding-bottom: 3rem;">
                            <div style="display: flex; justify-content: center">
                                {!$Label.c.BC_NoRating}
                            </div>
                            <div style="display: flex; font-size: 13px; color: darkgrey; font-weight: normal; justify-content: center">
                                {!$Label.c.BC_FirstReview}
                            </div>
                        </div>
                    </aura:if>
                    <aura:if isTrue="{!!empty(v.productWrapper)}">
                        <div style="padding-bottom: 2rem;">
                            <lightning:tabset aura:id="tabs" class="slds-card">
                                <lightning:tab id="productReviewTab" label="{!$Label.c.BC_Reviews}">
                                    <c:BC_ProductReviews aura:id="reviews" product="{!v.productWrapper}"/>
                                </lightning:tab>
                                <lightning:tab label="{!$Label.c.BC_AddReview}">
                                    <c:BC_AddProductReview product="{!v.productWrapper}" />
                                </lightning:tab>
                            </lightning:tabset>
                        </div>
                    </aura:if>
                </div>
            </lightning:layoutItem>
        </lightning:layout>
    </div>
</aura:component>